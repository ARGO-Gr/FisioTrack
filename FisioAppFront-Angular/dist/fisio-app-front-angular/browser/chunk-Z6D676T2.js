import{a as D}from"./chunk-X3IRCCKU.js";import{b as j,d as O,f as U,s as w}from"./chunk-BKO5ELJN.js";import{a as M}from"./chunk-RWZ5TKRV.js";import{a as x,b as R,e as I}from"./chunk-BV64I7NB.js";import{Ba as o,Bb as _,C as b,Ca as n,D as v,Da as T,Ja as m,Ka as u,Ta as s,Va as C,Ya as E,Za as F,_a as P,da as a,g as f,ha as l,la as h,pa as S,q as g,ta as d,ua as A,va as p,vb as y}from"./chunk-OSJLVL2X.js";function V(t,r){t&1&&(o(0,"span",10),s(1,"Reenviar C\xF3digo"),n())}function H(t,r){if(t&1&&(o(0,"span",10),s(1),n()),t&2){let i=u();a(),C("Reenviar (",i.remainingSeconds,"s)")}}function J(t,r){if(t&1&&T(0,"div",11),t&2){let i=u();A("width",i.remainingSeconds/30*100+"%")}}var N=class t{constructor(r,i,e,c){this.dialogRef=r;this.data=i;this.authService=e;this.toastService=c;this.dialogRef.disableClose=!1}isResendDisabled=!1;remainingSeconds=0;destroy$=new f;ngOnInit(){}resendCode(){this.isResendDisabled||this.authService.resendUnlockCode({email:this.data.email}).subscribe({next:()=>{this.toastService.success("C\xF3digo de desbloqueo reenviado a tu correo"),this.startCooldown()},error:r=>{this.toastService.error(r.error?.error||"Error al reenviar el c\xF3digo")}})}startCooldown(){this.isResendDisabled=!0,this.dialogRef.disableClose=!0,this.remainingSeconds=30,g(1e3).pipe(b(this.destroy$),v(()=>this.remainingSeconds>0)).subscribe(()=>{this.remainingSeconds--,this.remainingSeconds===0&&(this.isResendDisabled=!1,this.dialogRef.disableClose=!1)})}onCancel(){this.dialogRef.close()}ngOnDestroy(){this.destroy$.next(),this.destroy$.complete()}static \u0275fac=function(i){return new(i||t)(l(x),l(R),l(M),l(D))};static \u0275cmp=h({type:t,selectors:[["app-unlock-account-modal"]],decls:15,vars:16,consts:[[1,"p-6","max-w-md"],[1,"text-2xl","font-bold","text-foreground","mb-4"],[1,"text-muted-foreground","mb-6"],[1,"bg-muted/50","border","border-border","rounded-md","p-4","mb-6"],[1,"text-sm","text-muted-foreground"],[1,"flex","gap-3"],[1,"flex-1","px-4","py-2","rounded-md","border","border-border","text-foreground","hover:bg-muted","transition-colors","disabled:opacity-50","disabled:cursor-not-allowed",3,"click","disabled"],[1,"flex-1","px-4","py-2","rounded-md","bg-primary","text-primary-foreground","hover:bg-primary/90","transition-colors","disabled:opacity-50","disabled:cursor-not-allowed","relative","timer-button",3,"click","disabled","title"],["class","relative z-10",4,"ngIf"],["class","timer-fill",3,"width",4,"ngIf"],[1,"relative","z-10"],[1,"timer-fill"]],template:function(i,e){i&1&&(o(0,"div",0)(1,"h2",1),s(2,"Desbloquear Cuenta"),n(),o(3,"p",2),s(4," Tu cuenta ha sido bloqueada por seguridad. Se ha enviado un enlace de desbloqueo a tu correo electr\xF3nico. "),n(),o(5,"div",3)(6,"p",4),s(7," Si no recibes el correo en los pr\xF3ximos minutos, verifica tu carpeta de spam o usa el bot\xF3n de abajo para reenviar el c\xF3digo. "),n()(),o(8,"div",5)(9,"button",6),m("click",function(){return e.onCancel()}),s(10," Cerrar "),n(),o(11,"button",7),m("click",function(){return e.resendCode()}),S(12,V,2,0,"span",8)(13,H,2,1,"span",8)(14,J,1,2,"div",9),n()()()),i&2&&(a(9),p("opacity-50",e.isResendDisabled)("cursor-not-allowed",e.isResendDisabled),d("disabled",e.isResendDisabled),a(2),A("--remaining-percent",e.remainingSeconds/30*100+"%"),p("opacity-50",e.isResendDisabled)("cursor-not-allowed",e.isResendDisabled),d("disabled",e.isResendDisabled)("title",e.isResendDisabled?"Espera "+e.remainingSeconds+" segundos":""),a(),d("ngIf",!e.isResendDisabled),a(),d("ngIf",e.isResendDisabled),a(),d("ngIf",e.isResendDisabled))},dependencies:[_,y,w,I],styles:[".timer-button[_ngcontent-%COMP%]{position:relative;overflow:hidden}.timer-fill[_ngcontent-%COMP%]{position:absolute;left:0;top:0;height:100%;background-color:#0000001a;transition:width .3s linear;z-index:1}"]})};function K(t,r){t&1&&(o(0,"span"),s(1,"Enviar"),n())}function Q(t,r){if(t&1&&(o(0,"span"),s(1),n()),t&2){let i=u();a(),C("Enviar (",i.remainingSeconds,"s)")}}var $=class t{constructor(r,i,e,c){this.dialogRef=r;this.data=i;this.authService=e;this.toastService=c;this.dialogRef.disableClose=!1}email="";isSending=!1;remainingSeconds=0;destroy$=new f;sendPassword(){this.isSending||!this.email||this.authService.sendPassword({email:this.email}).subscribe({next:()=>{this.toastService.success("Contrase\xF1a temporal enviada a tu correo"),this.startCooldown()},error:r=>{this.toastService.error(r.error?.error||"Error al enviar la contrase\xF1a")}})}startCooldown(){this.isSending=!0,this.dialogRef.disableClose=!0,this.remainingSeconds=30,g(1e3).pipe(b(this.destroy$),v(()=>this.remainingSeconds>0)).subscribe(()=>{this.remainingSeconds--,this.remainingSeconds===0&&(this.isSending=!1,this.dialogRef.disableClose=!1)})}onCancel(){this.dialogRef.close()}ngOnDestroy(){this.destroy$.next(),this.destroy$.complete()}static \u0275fac=function(i){return new(i||t)(l(x),l(R),l(M),l(D))};static \u0275cmp=h({type:t,selectors:[["app-forgot-password-modal"]],decls:15,vars:11,consts:[[1,"p-6","max-w-md"],[1,"text-2xl","font-bold","text-foreground","mb-4"],[1,"text-muted-foreground","mb-6"],[1,"mb-6"],[1,"block","text-sm","font-medium","text-foreground","mb-2"],["type","email","placeholder","tu@correo.com",1,"w-full","px-3","py-2","rounded-md","border","border-input","bg-transparent","text-foreground","placeholder:text-muted-foreground","focus:outline-none","focus:ring-1","focus:ring-ring",3,"ngModelChange","ngModel","disabled"],[1,"flex","gap-3"],[1,"flex-1","px-4","py-2","rounded-md","border","border-border","text-foreground","hover:bg-muted","transition-colors","disabled:opacity-50",3,"click","disabled"],[1,"flex-1","px-4","py-2","rounded-md","bg-primary","text-primary-foreground","hover:bg-primary/90","transition-colors","disabled:opacity-50","disabled:cursor-not-allowed",3,"click","disabled","title"],[4,"ngIf"]],template:function(i,e){i&1&&(o(0,"div",0)(1,"h2",1),s(2,"Recuperar Contrase\xF1a"),n(),o(3,"p",2),s(4," Ingresa tu correo electr\xF3nico y te enviaremos una contrase\xF1a temporal para que puedas acceder a tu cuenta. "),n(),o(5,"div",3)(6,"label",4),s(7,"Correo Electr\xF3nico"),n(),o(8,"input",5),P("ngModelChange",function(k){return F(e.email,k)||(e.email=k),k}),n()(),o(9,"div",6)(10,"button",7),m("click",function(){return e.onCancel()}),s(11," Cancelar "),n(),o(12,"button",8),m("click",function(){return e.sendPassword()}),S(13,K,2,0,"span",9)(14,Q,2,1,"span",9),n()()()),i&2&&(a(8),E("ngModel",e.email),d("disabled",e.isSending),a(2),d("disabled",e.isSending),a(2),p("opacity-50",e.isSending||!e.email)("cursor-not-allowed",e.isSending||!e.email),d("disabled",e.isSending||!e.email)("title",e.isSending?"Espera "+e.remainingSeconds+" segundos":""),a(),d("ngIf",!e.isSending),a(),d("ngIf",e.isSending))},dependencies:[_,y,w,j,O,U,I],encapsulation:2})};export{N as a,$ as b};
