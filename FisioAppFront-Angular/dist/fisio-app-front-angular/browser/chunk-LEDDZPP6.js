import{a as Pe}from"./chunk-B7RCBSHE.js";import{a as De}from"./chunk-OX3AEPKD.js";import{b as J,c as V,d as L,e as re,f as je,g as ae,h as se,i as le,j as ce,n as Re,o as Te,p as Ae,r as de,s as Fe,t as B}from"./chunk-2SYUDXM5.js";import{a as Ve}from"./chunk-TCB6RIUV.js";import{a as k,b as j,c as me,e as w}from"./chunk-IJ4FMSKR.js";import{B as ye,Ba as n,Bb as E,C as P,Ca as i,Da as O,Ea as A,Fa as F,Ha as v,Ja as u,Ka as d,Na as Ce,P as p,Q as g,Sa as te,Ta as r,Ua as x,Va as C,Wa as Se,Ya as N,Za as W,_a as z,a as X,ab as $,b as Y,cb as ie,d as Z,da as l,db as ne,eb as Ee,fb as Me,g as T,ha as _,hb as oe,k as xe,la as S,pa as f,pc as M,qc as I,ta as m,tb as Ie,u as ve,ub as G,v as he,vb as D,wa as ee,xb as ke,yb as we}from"./chunk-3JF2NBPF.js";function Je(s,t){if(s&1){let e=v();n(0,"button",27),u("click",function(){let a=p(e).$implicit,c=d(3);return g(c.selectPaciente(a))}),n(1,"div",28)(2,"div",29)(3,"mat-icon",11),r(4,"person_outline"),i()()(),n(5,"div",30)(6,"p",31),r(7),i(),n(8,"p",32),r(9),i()()()}if(s&2){let e=t.$implicit;l(7),x(e.nombre),l(2),x(e.email)}}function Le(s,t){if(s&1&&(n(0,"div"),f(1,Je,10,2,"button",26),i()),s&2){let e=d().ngIf;l(),m("ngForOf",e)}}function Be(s,t){s&1&&(n(0,"div",33)(1,"mat-icon",34),r(2,"person_off"),i(),n(3,"p",35),r(4,"No se encontraron usuarios"),i()())}function qe(s,t){if(s&1&&(n(0,"div",24),f(1,Le,2,1,"div",25)(2,Be,5,0,"ng-template",null,0,oe),i()),s&2){let e=t.ngIf,o=te(3);l(),m("ngIf",e.length>0)("ngIfElse",o)}}function Ue(s,t){if(s&1){let e=v();n(0,"div",36)(1,"div",37)(2,"mat-icon",38),r(3,"check_circle"),i()(),n(4,"div",30)(5,"p",39),r(6),i(),n(7,"p",40),r(8),i()(),n(9,"button",41),u("click",function(){p(e);let a=d();return g(a.clearSelection())}),n(10,"mat-icon",42),r(11,"close"),i()()()}if(s&2){let e=d();l(6),x(e.selectedPaciente.nombre),l(2),x(e.selectedPaciente.email)}}function He(s,t){s&1&&(n(0,"div",43)(1,"mat-icon",44),r(2,"error"),i(),r(3," Debe seleccionar un usuario "),i())}function Ke(s,t){s&1&&(n(0,"mat-icon",44),r(1,"refresh"),i())}function Qe(s,t){s&1&&(n(0,"span"),r(1,"Vincular Paciente"),i())}function Xe(s,t){s&1&&(n(0,"span"),r(1,"Vinculando..."),i())}var Oe=class s{constructor(t,e,o){this.fb=t;this.appointmentService=e;this.dialogRef=o;this.patientForm=this.fb.group({pacienteId:["",V.required]}),this.filteredPacientes$=this.searchSubject$.pipe(he(300),ye(a=>!a||a.length<1?xe([]):this.appointmentService.searchPatients(a).pipe(ve(c=>(console.error("Error searching patients:",c),xe([]))))),P(this.destroy$))}patientForm;isSubmitting=!1;filteredPacientes$;destroy$=new T;searchSubject$=new T;searchText="";showDropdown=!1;selectedPaciente=null;ngOnInit(){}onSearchInput(t){let e=t.target;this.searchText=e.value,this.showDropdown=this.searchText.length>0,this.searchSubject$.next(this.searchText)}selectPaciente(t){this.selectedPaciente=t,this.searchText=t.nombre,this.showDropdown=!1,this.patientForm.patchValue({pacienteId:t.id}),this.patientForm.get("pacienteId")?.markAsTouched()}clearSelection(){this.selectedPaciente=null,this.searchText="",this.showDropdown=!1,this.patientForm.patchValue({pacienteId:""}),this.searchSubject$.next("")}isFieldInvalid(t){let e=this.patientForm.get(t);return!!(e&&e.invalid&&(e.dirty||e.touched))}onCancel(){this.dialogRef.close()}onSubmit(){this.patientForm.valid&&this.selectedPaciente&&(this.isSubmitting=!0,this.dialogRef.disableClose=!0,setTimeout(()=>{this.dialogRef.close({pacienteId:this.selectedPaciente.id,paciente:this.selectedPaciente})},500))}ngOnDestroy(){this.destroy$.next(),this.destroy$.complete()}static \u0275fac=function(e){return new(e||s)(_(de),_(Ve),_(k))};static \u0275cmp=S({type:s,selectors:[["app-add-patient-modal"]],decls:33,vars:13,consts:[["noUsuarios",""],[1,"w-full","max-w-4xl","flex","flex-col","max-h-fit"],[1,"flex","items-center","justify-between","mb-6","pb-2","border-b","border-border","px-6","pt-6","flex-shrink-0"],[1,"flex-1"],[1,"text-2xl","font-bold","text-foreground"],[1,"text-sm","text-muted-foreground","mt-2"],["type","button","title","Cerrar",1,"ml-4","p-0","rounded-lg","hover:bg-muted","transition-colors","text-muted-foreground","hover:text-foreground","flex-shrink-0",3,"click"],[1,"px-6","pt-0","pb-40"],[1,"space-y-8",3,"ngSubmit","formGroup"],[1,"space-y-4"],[1,"text-sm","font-semibold","text-foreground","flex","items-center","gap-2"],[1,"text-primary","!size-5"],[1,"relative"],["type","text","placeholder","Busca por nombre o email...",1,"w-full","px-4","py-3","border","border-input","rounded-lg","bg-background","text-foreground","placeholder:text-muted-foreground","focus:outline-none","focus:ring-2","focus:ring-primary","focus:border-transparent","transition-all",3,"input","value"],[1,"absolute","right-3","top-1/2","-translate-y-1/2","text-muted-foreground","pointer-events-none","!size-5"],["class","absolute top-full left-0 right-0 mt-2 border border-input rounded-lg bg-card shadow-lg z-50 max-h-64 overflow-y-auto",4,"ngIf"],["class","flex items-center gap-3 p-3 bg-primary/5 border border-primary/20 rounded-lg",4,"ngIf"],["type","hidden","formControlName","pacienteId",3,"value"],["class","text-sm text-destructive flex items-center gap-1 mt-2",4,"ngIf"],[1,"flex","gap-3","px-6","pb-6","border-t","border-border","flex-shrink-0","pt-6"],["type","button",1,"flex-1","px-4","py-3","rounded-lg","border","border-border","text-foreground","bg-background","hover:bg-muted","transition-colors","disabled:opacity-50","disabled:cursor-not-allowed","font-medium",3,"click","disabled"],["type","submit",1,"flex-1","px-4","py-3","rounded-lg","bg-primary","text-primary-foreground","hover:bg-primary/90","transition-colors","disabled:opacity-50","disabled:cursor-not-allowed","font-medium","flex","items-center","justify-center","gap-2",3,"click","disabled"],["class","!size-4",4,"ngIf"],[4,"ngIf"],[1,"absolute","top-full","left-0","right-0","mt-2","border","border-input","rounded-lg","bg-card","shadow-lg","z-50","max-h-64","overflow-y-auto"],[4,"ngIf","ngIfElse"],["type","button","class","w-full px-4 py-3 text-left hover:bg-muted transition-colors border-b border-border last:border-b-0 flex items-center gap-3 group",3,"click",4,"ngFor","ngForOf"],["type","button",1,"w-full","px-4","py-3","text-left","hover:bg-muted","transition-colors","border-b","border-border","last:border-b-0","flex","items-center","gap-3","group",3,"click"],[1,"flex-shrink-0"],[1,"w-10","h-10","rounded-full","bg-primary/10","flex","items-center","justify-center","group-hover:bg-primary/20","transition-colors"],[1,"flex-1","min-w-0"],[1,"font-medium","text-foreground","truncate"],[1,"text-sm","text-muted-foreground","truncate"],[1,"px-4","py-6","text-center"],[1,"text-muted-foreground","!size-8","mb-2","block"],[1,"text-muted-foreground","text-sm"],[1,"flex","items-center","gap-3","p-3","bg-primary/5","border","border-primary/20","rounded-lg"],[1,"w-8","h-8","rounded-full","bg-primary/10","flex","items-center","justify-center","flex-shrink-0"],[1,"text-primary","!size-4"],[1,"font-medium","text-foreground","text-sm","truncate"],[1,"text-xs","text-muted-foreground","truncate"],["type","button","title","Limpiar selecci\xF3n",1,"p-1","hover:bg-primary/10","rounded","transition-colors",3,"click"],[1,"text-muted-foreground","!size-5","hover:text-foreground","transition-colors"],[1,"text-sm","text-destructive","flex","items-center","gap-1","mt-2"],[1,"!size-4"]],template:function(e,o){e&1&&(n(0,"div",1)(1,"div",2)(2,"div",3)(3,"h2",4),r(4,"Vincular Paciente"),i(),n(5,"p",5),r(6,"Selecciona un usuario registrado para vincularlo como paciente"),i()(),n(7,"button",6),u("click",function(){return o.onCancel()}),n(8,"mat-icon"),r(9,"close"),i()()(),n(10,"div",7)(11,"form",8),u("ngSubmit",function(){return o.onSubmit()}),n(12,"div",9)(13,"label",10)(14,"mat-icon",11),r(15,"person"),i(),r(16," Usuario * "),i(),n(17,"div",12)(18,"input",13),u("input",function(c){return o.onSearchInput(c)}),i(),n(19,"mat-icon",14),r(20,"search"),i(),f(21,qe,4,2,"div",15),ne(22,"async"),i(),f(23,Ue,12,2,"div",16),O(24,"input",17),f(25,He,4,0,"div",18),i()()(),n(26,"div",19)(27,"button",20),u("click",function(){return o.onCancel()}),r(28," Cancelar "),i(),n(29,"button",21),u("click",function(){return o.onSubmit()}),f(30,Ke,2,0,"mat-icon",22)(31,Qe,2,0,"span",23)(32,Xe,2,0,"span",23),i()()()),e&2&&(l(11),m("formGroup",o.patientForm),l(7),m("value",o.searchText),l(3),m("ngIf",o.showDropdown&&Ee(22,11,o.filteredPacientes$)),l(2),m("ngIf",o.selectedPaciente),l(),m("value",(o.selectedPaciente==null?null:o.selectedPaciente.id)||""),l(),m("ngIf",o.isFieldInvalid("pacienteId")),l(2),m("disabled",o.isSubmitting),l(2),m("disabled",!o.patientForm.valid||o.isSubmitting),l(),m("ngIf",o.isSubmitting),l(),m("ngIf",!o.isSubmitting),l(),m("ngIf",o.isSubmitting))},dependencies:[E,G,D,ke,B,ae,J,L,re,le,ce,w,I,M],styles:["[_nghost-%COMP%]     .mat-mdc-dialog-container{padding:0!important}"]})};var q=class s{constructor(t,e){this.dialogRef=t;this.data=e;e?.title&&(this.title=e.title),e?.message&&(this.message=e.message)}title="\xBFDescartar Cambios?";message="Tienes cambios sin guardar. Si contin\xFAas, se perder\xE1n todos los datos ingresados.";onKeepEditing(){this.dialogRef.close(!1)}onDiscard(){this.dialogRef.close(!0)}onCancel(){this.dialogRef.close(!1)}static \u0275fac=function(e){return new(e||s)(_(k),_(j))};static \u0275cmp=S({type:s,selectors:[["app-confirm-discard-changes-modal"]],decls:20,vars:2,consts:[[1,"w-full","flex","flex-col"],[1,"flex","items-center","justify-between","mb-6","pb-4","border-b","border-border","px-6","pt-6","flex-shrink-0"],[1,"flex","items-center","gap-3"],[1,"flex","items-center","justify-center","w-10","h-10","rounded-lg","bg-warning/10"],[1,"text-warning","!size-6"],[1,"text-xl","font-bold","text-foreground"],["type","button","title","Cerrar",1,"p-0","rounded-lg","hover:bg-muted","transition-colors","text-muted-foreground","hover:text-foreground",3,"click"],[1,"px-6","pb-6","flex-1"],[1,"text-base","text-muted-foreground","mb-6"],[1,"flex","gap-3","px-6","pb-6","border-t","border-border","pt-6","flex-shrink-0"],["type","button",1,"flex-1","px-4","py-3","rounded-lg","bg-primary","text-primary-foreground","hover:bg-primary/90","transition-colors","font-medium",3,"click"],["type","button",1,"flex-1","px-4","py-3","rounded-lg","border","border-destructive/30","text-destructive","bg-destructive/5","hover:bg-destructive/10","transition-colors","font-medium",3,"click"]],template:function(e,o){e&1&&(n(0,"div",0)(1,"div",1)(2,"div",2)(3,"div",3)(4,"mat-icon",4),r(5,"warning"),i()(),n(6,"div")(7,"h2",5),r(8),i()()(),n(9,"button",6),u("click",function(){return o.onCancel()}),n(10,"mat-icon"),r(11,"close"),i()()(),n(12,"div",7)(13,"p",8),r(14),i()(),n(15,"div",9)(16,"button",10),u("click",function(){return o.onKeepEditing()}),r(17," Continuar Editando "),i(),n(18,"button",11),u("click",function(){return o.onDiscard()}),r(19," Descartar Cambios "),i()()()),e&2&&(l(8),x(o.title),l(6),x(o.message))},dependencies:[E,w,I,M],styles:["[_nghost-%COMP%]     .mat-mdc-dialog-container{padding:0!important;max-width:500px!important}[_nghost-%COMP%]     .cdk-overlay-pane{max-width:500px!important}"]})};var K=()=>({updateOn:"blur"});function Ye(s,t){if(s&1){let e=v();n(0,"button",41),u("click",function(){p(e);let a=d().$implicit,c=d();return g(c.eliminarEjercicio(a.id))}),n(1,"mat-icon",23),r(2,"delete"),i()()}}function Ze(s,t){if(s&1){let e=v();n(0,"button",49),u("click",function(){p(e);let a=d().index,c=d().$implicit,b=d();return g(b.eliminarInstruccion(c.id,a))}),n(1,"mat-icon",12),r(2,"delete"),i()()}}function et(s,t){if(s&1){let e=v();n(0,"div",42)(1,"div",21)(2,"button",43),u("click",function(){let a=p(e).index,c=d().$implicit,b=d();return g(b.moverInstruccion(c.id,a,a-1))}),n(3,"mat-icon",12),r(4,"expand_less"),i()(),n(5,"button",44),u("click",function(){let a=p(e).index,c=d().$implicit,b=d();return g(b.moverInstruccion(c.id,a,a+1))}),n(6,"mat-icon",12),r(7,"expand_more"),i()()(),n(8,"div",45)(9,"span",46),r(10),i(),n(11,"input",47),z("ngModelChange",function(a){let c=p(e).index,b=d().$implicit;return W(b.instrucciones[c],a)||(b.instrucciones[c]=a),g(a)}),i(),f(12,Ze,3,0,"button",48),i()()}if(s&2){let e=t.index,o=d().$implicit;l(2),m("disabled",e===0),l(3),m("disabled",e===o.instrucciones.length-1),l(5),C(" ",e+1,". "),l(),Ce("placeholder","Paso ",e+1,""),N("ngModel",o.instrucciones[e]),m("ngModelOptions",$(8,K)),l(),m("ngIf",o.instrucciones.length>1)}}function tt(s,t){if(s&1){let e=v();n(0,"div",19)(1,"div",20)(2,"div",21)(3,"button",22),u("click",function(){let a=p(e).index,c=d();return g(c.moverEjercicio(a,"arriba"))}),n(4,"mat-icon",23),r(5,"expand_less"),i()(),n(6,"button",24),u("click",function(){let a=p(e).index,c=d();return g(c.moverEjercicio(a,"abajo"))}),n(7,"mat-icon",23),r(8,"expand_more"),i()()(),n(9,"div",25)(10,"div",26)(11,"h4",27),r(12),i(),n(13,"div",28)(14,"button",29),u("click",function(){let a=p(e).index,c=d();return g(c.duplicarEjercicio(a))}),n(15,"mat-icon",12),r(16,"content_copy"),i(),r(17," Duplicar "),i(),f(18,Ye,3,0,"button",30),i()(),n(19,"div",31)(20,"label",32),r(21,"Nombre del Ejercicio *"),i(),n(22,"input",33),z("ngModelChange",function(a){let c=p(e).$implicit;return W(c.nombre,a)||(c.nombre=a),g(a)}),i()(),n(23,"div",31)(24,"label",32),r(25,"Descripci\xF3n Breve *"),i(),n(26,"input",34),z("ngModelChange",function(a){let c=p(e).$implicit;return W(c.descripcion,a)||(c.descripcion=a),g(a)}),i()(),n(27,"div",35)(28,"div",31)(29,"label",32),r(30,"Repeticiones *"),i(),n(31,"input",36),z("ngModelChange",function(a){let c=p(e).$implicit;return W(c.repeticiones,a)||(c.repeticiones=a),g(a)}),i()(),n(32,"div",31)(33,"label",32),r(34,"Descanso (seg) *"),i(),n(35,"input",37),z("ngModelChange",function(a){let c=p(e).$implicit;return W(c.descanso,a)||(c.descanso=a),g(a)}),i()()(),n(36,"div",31)(37,"div",26)(38,"label",32),r(39,"Instrucciones Paso a Paso *"),i(),n(40,"button",38),u("click",function(){let a=p(e).$implicit,c=d();return g(c.agregarInstruccion(a.id))}),n(41,"mat-icon",39),r(42,"add"),i(),r(43," Agregar Paso "),i()(),n(44,"div",31),f(45,et,13,9,"div",40),i()()()()()}if(s&2){let e=t.$implicit,o=t.index,a=d();l(3),m("disabled",o===0),l(3),m("disabled",o===a.ejercicios.length-1),l(6),C("Ejercicio ",o+1,""),l(6),m("ngIf",a.ejercicios.length>1),l(4),N("ngModel",e.nombre),m("ngModelOptions",$(13,K)),l(4),N("ngModel",e.descripcion),m("ngModelOptions",$(14,K)),l(5),N("ngModel",e.repeticiones),m("ngModelOptions",$(15,K)),l(4),N("ngModel",e.descanso),m("ngModelOptions",$(16,K)),l(10),m("ngForOf",e.instrucciones)}}function it(s,t){s&1&&(n(0,"mat-icon",12),r(1,"refresh"),i())}function nt(s,t){s&1&&(n(0,"span"),r(1,"Guardar Ejercicios"),i())}function ot(s,t){s&1&&(n(0,"span"),r(1,"Guardando..."),i())}var Q=class s{constructor(t,e,o){this.dialog=t;this.dialogRef=e;this.data=o;this.dayIndex=o.dayIndex,this.dayName=o.dayName,this.ejercicios=o.exercises?JSON.parse(JSON.stringify(o.exercises)):[],this.ejerciciosOriginales=JSON.parse(JSON.stringify(this.ejercicios))}ejercicios=[];isSubmitting=!1;dayIndex=0;dayName="";ejerciciosOriginales=[];destroy$=new T;ngOnInit(){this.ejercicios.length===0&&this.agregarEjercicio()}agregarEjercicio(){let t={id:`ejercicio_${Date.now()}_${Math.random()}`,nombre:"",descripcion:"",repeticiones:10,descanso:30,instrucciones:[""]};this.ejercicios.push(t)}eliminarEjercicio(t){this.ejercicios=this.ejercicios.filter(e=>e.id!==t)}duplicarEjercicio(t){let e=this.ejercicios[t],o=Y(X({},JSON.parse(JSON.stringify(e))),{id:`ejercicio_${Date.now()}_${Math.random()}`});this.ejercicios.splice(t+1,0,o)}actualizarEjercicio(t,e,o){let a=this.ejercicios.find(c=>c.id===t);a&&(a[e]=o)}actualizarEjercicioNombre(t,e){this.actualizarEjercicio(t,"nombre",e.target.value)}actualizarEjercicioDescripcion(t,e){this.actualizarEjercicio(t,"descripcion",e.target.value)}actualizarEjercicioRepeticiones(t,e){let o=Number.parseInt(e.target.value)||0;this.actualizarEjercicio(t,"repeticiones",o)}actualizarEjercicioDescanso(t,e){let o=Number.parseInt(e.target.value)||0;this.actualizarEjercicio(t,"descanso",o)}moverEjercicio(t,e){e==="arriba"&&t>0?[this.ejercicios[t],this.ejercicios[t-1]]=[this.ejercicios[t-1],this.ejercicios[t]]:e==="abajo"&&t<this.ejercicios.length-1&&([this.ejercicios[t],this.ejercicios[t+1]]=[this.ejercicios[t+1],this.ejercicios[t]])}agregarInstruccion(t){let e=this.ejercicios.find(o=>o.id===t);e&&e.instrucciones.push("")}eliminarInstruccion(t,e){let o=this.ejercicios.find(a=>a.id===t);o&&o.instrucciones.splice(e,1)}actualizarInstruccion(t,e,o){let a=this.ejercicios.find(c=>c.id===t);a&&(a.instrucciones[e]=o)}actualizarInstruccionTexto(t,e,o){this.actualizarInstruccion(t,e,o.target.value)}moverInstruccion(t,e,o){let a=this.ejercicios.find(c=>c.id===t);if(a){let[c]=a.instrucciones.splice(e,1);a.instrucciones.splice(o,0,c)}}allExercisesValid(){return this.ejercicios.every(t=>t.nombre.trim()!==""&&t.descripcion.trim()!==""&&t.repeticiones>0&&t.instrucciones.every(e=>e.trim()!==""))}hasChanges(){return JSON.stringify(this.ejercicios)!==JSON.stringify(this.ejerciciosOriginales)}onCancel(){return Z(this,null,function*(){this.hasChanges()?(yield this.dialog.open(q,{width:"90%",maxWidth:"500px",data:{title:"\xBFDescartar cambios?",message:"Tienes cambios sin guardar en los ejercicios. Si contin\xFAas, se perder\xE1n todos los datos ingresados."},disableClose:!1}).afterClosed().toPromise())&&this.dialogRef.close():this.dialogRef.close()})}onSubmit(){this.allExercisesValid()&&(this.isSubmitting=!0,this.dialogRef.disableClose=!0,setTimeout(()=>{this.dialogRef.close({dayIndex:this.dayIndex,exercises:this.ejercicios})},500))}ngOnDestroy(){this.destroy$.next(),this.destroy$.complete()}static \u0275fac=function(e){return new(e||s)(_(me),_(k),_(j))};static \u0275cmp=S({type:s,selectors:[["app-exercises-modal"]],decls:31,vars:6,consts:[[1,"w-full","max-w-4xl","flex","flex-col","max-h-[95vh]","overflow-hidden"],[1,"flex","items-center","justify-between","mb-6","pb-4","border-b","border-border","px-6","pt-6","flex-shrink-0"],[1,"flex-1"],[1,"text-3xl","font-bold","text-foreground"],[1,"text-sm","text-muted-foreground","mt-2"],["type","button","title","Cerrar",1,"ml-4","p-0","rounded-lg","hover:bg-muted","transition-colors","text-muted-foreground","hover:text-foreground","flex-shrink-0",3,"click"],[1,"overflow-y-auto","flex-1","px-6","pb-6"],[1,"space-y-4"],[1,"flex","items-center","justify-between","mb-4"],[1,"text-lg","font-semibold","text-foreground"],[1,"text-sm","text-muted-foreground"],["type","button",1,"px-4","py-2","rounded-lg","bg-primary","text-primary-foreground","hover:bg-primary/90","transition-colors","text-sm","font-medium","flex","items-center","gap-2",3,"click"],[1,"!size-4"],["class","p-4 rounded-lg border border-border bg-muted/30",4,"ngFor","ngForOf"],[1,"flex","gap-3","px-6","pb-6","border-t","border-border","flex-shrink-0","pt-6"],["type","button",1,"flex-1","px-4","py-3","rounded-lg","border","border-border","text-foreground","bg-background","hover:bg-muted","transition-colors","font-medium",3,"click"],["type","submit",1,"flex-1","px-4","py-3","rounded-lg","bg-primary","text-primary-foreground","hover:bg-primary/90","transition-colors","disabled:opacity-50","disabled:cursor-not-allowed","font-medium","flex","items-center","justify-center","gap-2",3,"click","disabled"],["class","!size-4",4,"ngIf"],[4,"ngIf"],[1,"p-4","rounded-lg","border","border-border","bg-muted/30"],[1,"flex","items-start","gap-3","mb-4"],[1,"flex","flex-col","gap-1","pt-2"],["type","button","title","Mover arriba",1,"text-muted-foreground","hover:text-foreground","disabled:opacity-30","disabled:cursor-not-allowed","transition-colors",3,"click","disabled"],[1,"!size-5"],["type","button","title","Mover abajo",1,"text-muted-foreground","hover:text-foreground","disabled:opacity-30","disabled:cursor-not-allowed","transition-colors",3,"click","disabled"],[1,"flex-1","space-y-4"],[1,"flex","items-center","justify-between"],[1,"font-semibold","text-foreground"],[1,"flex","items-center","gap-2"],["type","button","title","Duplicar ejercicio",1,"px-2","py-1","rounded-lg","border","border-blue-300/50","text-blue-600","bg-blue-50","hover:bg-blue-100","transition-colors","text-xs","font-medium","flex","items-center","gap-1",3,"click"],["type","button","class","p-2 rounded-lg hover:bg-destructive/10 transition-colors text-destructive","title","Eliminar ejercicio",3,"click",4,"ngIf"],[1,"space-y-2"],[1,"text-sm","font-semibold","text-foreground"],["type","text","placeholder","Ej: Flexi\xF3n de rodilla asistida","required","",1,"w-full","px-4","py-2","border","border-input","rounded-lg","bg-background","text-foreground","placeholder:text-muted-foreground","focus:outline-none","focus:ring-2","focus:ring-primary","focus:border-transparent","transition-all",3,"ngModelChange","ngModel","ngModelOptions"],["type","text","placeholder","Ej: Ejercicio para mejorar movilidad de rodilla","required","",1,"w-full","px-4","py-2","border","border-input","rounded-lg","bg-background","text-foreground","placeholder:text-muted-foreground","focus:outline-none","focus:ring-2","focus:ring-primary","focus:border-transparent","transition-all",3,"ngModelChange","ngModel","ngModelOptions"],[1,"grid","grid-cols-2","gap-3"],["type","number","min","1","max","100","required","",1,"w-full","px-4","py-2","border","border-input","rounded-lg","bg-background","text-foreground","placeholder:text-muted-foreground","focus:outline-none","focus:ring-2","focus:ring-primary","focus:border-transparent","transition-all",3,"ngModelChange","ngModel","ngModelOptions"],["type","number","min","0","max","300","step","15","required","",1,"w-full","px-4","py-2","border","border-input","rounded-lg","bg-background","text-foreground","placeholder:text-muted-foreground","focus:outline-none","focus:ring-2","focus:ring-primary","focus:border-transparent","transition-all",3,"ngModelChange","ngModel","ngModelOptions"],["type","button",1,"px-3","py-1","rounded-lg","border","border-border","text-foreground","bg-background","hover:bg-muted","transition-colors","text-xs","font-medium","flex","items-center","gap-1",3,"click"],[1,"!size-3"],["class","flex items-start gap-2",4,"ngFor","ngForOf"],["type","button","title","Eliminar ejercicio",1,"p-2","rounded-lg","hover:bg-destructive/10","transition-colors","text-destructive",3,"click"],[1,"flex","items-start","gap-2"],["type","button","title","Mover arriba",1,"text-muted-foreground","hover:text-foreground","disabled:opacity-30","disabled:cursor-not-allowed",3,"click","disabled"],["type","button","title","Mover abajo",1,"text-muted-foreground","hover:text-foreground","disabled:opacity-30","disabled:cursor-not-allowed",3,"click","disabled"],[1,"flex-1","flex","items-center","gap-2"],[1,"text-sm","font-medium","text-muted-foreground","min-w-[24px]"],["type","text","required","",1,"flex-1","px-4","py-2","border","border-input","rounded-lg","bg-background","text-foreground","placeholder:text-muted-foreground","focus:outline-none","focus:ring-2","focus:ring-primary","focus:border-transparent","transition-all",3,"ngModelChange","placeholder","ngModel","ngModelOptions"],["type","button","class","p-2 rounded-lg hover:bg-destructive/10 transition-colors text-destructive","title","Eliminar instrucci\xF3n",3,"click",4,"ngIf"],["type","button","title","Eliminar instrucci\xF3n",1,"p-2","rounded-lg","hover:bg-destructive/10","transition-colors","text-destructive",3,"click"]],template:function(e,o){e&1&&(n(0,"div",0)(1,"div",1)(2,"div",2)(3,"h2",3),r(4,"Ejercicios"),i(),n(5,"p",4),r(6),i()(),n(7,"button",5),u("click",function(){return o.onCancel()}),n(8,"mat-icon"),r(9,"close"),i()()(),n(10,"div",6)(11,"div",7)(12,"div",8)(13,"div")(14,"h3",9),r(15,"Ejercicios"),i(),n(16,"p",10),r(17,"Agrega los ejercicios de la rutina"),i()(),n(18,"button",11),u("click",function(){return o.agregarEjercicio()}),n(19,"mat-icon",12),r(20,"add"),i(),r(21," Agregar "),i()(),n(22,"div",7),f(23,tt,46,17,"div",13),i()()(),n(24,"div",14)(25,"button",15),u("click",function(){return o.onCancel()}),r(26," Cancelar "),i(),n(27,"button",16),u("click",function(){return o.onSubmit()}),f(28,it,2,0,"mat-icon",17)(29,nt,2,0,"span",18)(30,ot,2,0,"span",18),i()()()),e&2&&(l(6),x(o.dayName),l(17),m("ngForOf",o.ejercicios),l(4),m("disabled",!o.allExercisesValid()||o.isSubmitting),l(),m("ngIf",o.isSubmitting),l(),m("ngIf",!o.isSubmitting),l(),m("ngIf",o.isSubmitting))},dependencies:[E,G,D,B,J,se,L,Ae,Te,Re,Fe,je,w,I,M],styles:["[_nghost-%COMP%]{display:flex;align-items:center;justify-content:center}:is()   .mat-mdc-dialog-container[_ngcontent-%COMP%]{padding:0!important}:is()   .cdk-overlay-pane[_ngcontent-%COMP%]{z-index:1200!important}.overflow-y-auto[_ngcontent-%COMP%]{scroll-behavior:smooth}input[type=number][_ngcontent-%COMP%]::-webkit-outer-spin-button, input[type=number][_ngcontent-%COMP%]::-webkit-inner-spin-button{-webkit-appearance:none;margin:0}input[type=number][_ngcontent-%COMP%]{appearance:textfield;-moz-appearance:textfield}mat-icon[_ngcontent-%COMP%]{display:inline-flex;align-items:center;justify-content:center;width:1.25rem;height:1.25rem;line-height:1.25rem;font-size:1.25rem;flex-shrink:0}"]})};function rt(s,t){if(s&1){let e=v();n(0,"div",31)(1,"div",32)(2,"button",33),u("click",function(){p(e);let a=d();return g(a.cambiarTab("editar"))}),r(3," Editar Rutina Actual "),i(),n(4,"button",33),u("click",function(){p(e);let a=d();return g(a.cambiarTab("nueva"))}),r(5," Nueva Rutina "),i()()()}if(s&2){let e=d();l(2),ee("px-4 py-2 font-medium transition-colors "+(e.activeTab==="editar"?"text-primary border-b-2 border-primary":"text-muted-foreground hover:text-foreground")),l(2),ee("px-4 py-2 font-medium transition-colors "+(e.activeTab==="nueva"?"text-primary border-b-2 border-primary":"text-muted-foreground hover:text-foreground"))}}function at(s,t){s&1&&(n(0,"div",34)(1,"mat-icon"),r(2,"error"),i(),r(3," El nombre del programa es requerido "),i())}function st(s,t){s&1&&(n(0,"div",34)(1,"mat-icon"),r(2,"error"),i(),r(3," El diagn\xF3stico es requerido "),i())}function lt(s,t){s&1&&(n(0,"div",34)(1,"mat-icon"),r(2,"error"),i(),r(3," La duraci\xF3n es requerida "),i())}function ct(s,t){if(s&1){let e=v();A(0),n(1,"button",40),u("click",function(a){p(e);let c=d().index;return d(2).iniciarCopiaSemana(c),g(a.stopPropagation())}),r(2," Copiar "),i(),n(3,"button",41),u("click",function(a){p(e);let c=d().index;return d(2).resetearSemana(c),g(a.stopPropagation())}),r(4," Resetear "),i(),F()}}function dt(s,t){if(s&1){let e=v();A(0),n(1,"button",42),u("click",function(a){p(e);let c=d().index;return d(2).pegarSemana(c),g(a.stopPropagation())}),r(2," Pegar "),i(),n(3,"button",43),u("click",function(a){return p(e),d(3).cancelarCopiaSemana(),g(a.stopPropagation())}),r(4," Cancelar "),i(),F()}if(s&2){let e=d().index,o=d(2);l(),m("disabled",o.copiedWeekIndex===e)}}function mt(s,t){if(s&1){let e=v();n(0,"div",37),u("click",function(){let a=p(e).index,c=d(2);return g(c.seleccionarSemana(a))}),n(1,"div",38)(2,"h4",39),r(3),i()(),n(4,"div",18),f(5,ct,5,0,"ng-container",30)(6,dt,5,1,"ng-container",30),i()()}if(s&2){let e=t.$implicit,o=t.index,a=d(2);ee("p-4 rounded-lg border-2 transition-colors cursor-pointer "+(a.selectedWeekIndex===o?"border-primary bg-primary/10":"border-border bg-muted/30 hover:bg-muted/50")),l(3),C("Semana ",e.semana,""),l(2),m("ngIf",a.copiedWeekIndex===null),l(),m("ngIf",a.copiedWeekIndex!==null)}}function ut(s,t){if(s&1&&(n(0,"div",9)(1,"h3",10)(2,"mat-icon",11),r(3,"date_range"),i(),r(4," Gesti\xF3n de Semanas "),i(),n(5,"div",35),f(6,mt,7,5,"div",36),i()()),s&2){let e=d();l(6),m("ngForOf",e.semanasRutina)}}function pt(s,t){if(s&1&&(n(0,"span",44),r(1),i()),s&2){let e=d();l(),C("Semana ",e.selectedWeekIndex+1,"")}}function gt(s,t){s&1&&(n(0,"div",50)(1,"span",51),r(2," D\xEDa de Descanso "),i()())}function ft(s,t){s&1&&(n(0,"div",50)(1,"span",52),r(2," Ejercicios Asignados "),i()())}function xt(s,t){s&1&&(n(0,"div",50)(1,"p",22),r(2,"Sin asignar"),i()())}function bt(s,t){if(s&1){let e=v();A(0),n(1,"button",53),u("click",function(){p(e);let a=d().index,c=d();return g(c.seleccionarTipoDia(a,"descanso"))}),r(2," Descanso "),i(),n(3,"button",54),u("click",function(){p(e);let a=d().index,c=d();return g(c.seleccionarTipoDia(a,"rutina"))}),r(4," Ejercicios "),i(),F()}}function _t(s,t){if(s&1){let e=v();A(0),n(1,"button",55),u("click",function(){p(e);let a=d().index,c=d();return g(c.pegarRutina(a))}),r(2," Pegar "),i(),n(3,"button",53),u("click",function(){p(e);let a=d(2);return g(a.cancelarCopia())}),r(4," Cancelar "),i(),F()}}function vt(s,t){if(s&1){let e=v();A(0),n(1,"button",53),u("click",function(){p(e);let a=d().index,c=d();return g(c.cambiarDia(a))}),r(2," Cambiar "),i(),F()}}function ht(s,t){if(s&1){let e=v();A(0),n(1,"button",56),u("click",function(){p(e);let a=d().index,c=d();return g(c.abrirModalEjercicios(a))}),n(2,"mat-icon"),r(3,"edit"),i(),r(4," Ejercicios "),i(),n(5,"button",57),u("click",function(){p(e);let a=d().index,c=d();return g(c.iniciarCopia(a))}),r(6," Copiar "),i(),n(7,"button",58),u("click",function(){p(e);let a=d().index,c=d();return g(c.eliminarRutinaDia(a))}),r(8," Eliminar "),i(),F()}}function yt(s,t){if(s&1&&(n(0,"div",45)(1,"div",46)(2,"div",47)(3,"mat-icon",48),r(4,"calendar_today"),i(),n(5,"div")(6,"h4",39),r(7),i(),f(8,gt,3,0,"div",49)(9,ft,3,0,"div",49)(10,xt,3,0,"div",49),i()(),n(11,"div",18),f(12,bt,5,0,"ng-container",30)(13,_t,5,0,"ng-container",30)(14,vt,3,0,"ng-container",30)(15,ht,9,0,"ng-container",30),i()()()),s&2){let e=t.$implicit,o=d();l(7),x(e.dia),l(),m("ngIf",e.tipo==="descanso"),l(),m("ngIf",e.tipo==="rutina"),l(),m("ngIf",e.tipo===null),l(2),m("ngIf",e.tipo===null&&o.copiedFromIndex===null),l(),m("ngIf",e.tipo===null&&o.copiedFromIndex!==null),l(),m("ngIf",e.tipo==="descanso"),l(),m("ngIf",e.tipo==="rutina")}}function Ct(s,t){s&1&&(n(0,"mat-icon"),r(1,"refresh"),i())}function St(s,t){s&1&&(n(0,"span"),r(1,"Actualizar Rutina"),i())}function Et(s,t){if(s&1&&(n(0,"span"),r(1),i()),s&2){let e=d();l(),x(e.programaActivo?"Crear Nueva Rutina":"Guardar Rutina")}}function Mt(s,t){s&1&&(n(0,"span"),r(1,"Guardando..."),i())}var We=class s{constructor(t,e,o,a,c,b){this.fb=t;this.dialog=e;this.programaService=o;this.toastService=a;this.dialogRef=c;this.data=b;this.pacienteName=b.pacienteName,this.pacienteId=b.pacienteId,this.programaActivo=b.programaActivo||null,this.programaActivo&&(this.activeTab="editar",this.modoEdicion="editar"),this.routineForm=this.fb.group({nombrePrograma:["",V.required],diagnostico:["",V.required],semanas:[2,[V.required,V.min(1)]]})}routineForm;isSubmitting=!1;pacienteName="";pacienteId="";programaActivo=null;modoEdicion="nueva";activeTab="nueva";copiedFromIndex=null;copiedWeekIndex=null;selectedWeekIndex=0;semanasRutina=[];diasSemana=[{dia:"Lunes",tipo:null},{dia:"Martes",tipo:null},{dia:"Mi\xE9rcoles",tipo:null},{dia:"Jueves",tipo:null},{dia:"Viernes",tipo:null},{dia:"S\xE1bado",tipo:null},{dia:"Domingo",tipo:null}];formValueOrigin;destroy$=new T;ngOnInit(){this.programaActivo?this.cargarProgramaActivo():this.actualizarSemanas(),this.formValueOrigin=JSON.stringify({form:this.routineForm.value,semanas:this.semanasRutina}),this.routineForm.get("semanas")?.valueChanges.pipe(P(this.destroy$)).subscribe(()=>{this.actualizarSemanas()})}actualizarSemanas(){let t=this.routineForm.get("semanas")?.value||1,e=this.semanasRutina.length;if(t>e)for(let o=e+1;o<=t;o++)this.semanasRutina.push({semana:o,dias:JSON.parse(JSON.stringify(this.diasSemana))});else t<e&&(this.semanasRutina=this.semanasRutina.slice(0,t))}incrementarSemanas(){let t=this.routineForm.get("semanas"),e=t?.value||1;t?.setValue(e+1)}decrementarSemanas(){let t=this.routineForm.get("semanas"),e=t?.value||1;e>1&&t?.setValue(e-1)}cargarProgramaActivo(){this.programaActivo&&(this.routineForm.patchValue({nombrePrograma:this.programaActivo.nombre,diagnostico:this.programaActivo.diagnostico,semanas:this.programaActivo.totalSemanas}),this.semanasRutina=this.programaActivo.semanas.map(t=>({semana:t.numeroSemana,dias:t.dias.map(e=>({dia:e.nombreDia,tipo:e.tipo==="Rutina"||e.tipo==="rutina"?"rutina":"descanso",ejercicios:e.tipo==="Rutina"||e.tipo==="rutina"?e.ejercicios.map(a=>({id:`ejercicio_${a.id}_${Date.now()}`,nombre:a.nombre,descripcion:a.descripcion,repeticiones:a.repeticiones,descanso:a.tiempoDescanso,instrucciones:a.instrucciones})):[]}))})),this.formValueOrigin=JSON.stringify({form:this.routineForm.value,semanas:this.semanasRutina}))}cambiarTab(t){this.activeTab!==t&&(t==="nueva"?(this.activeTab="nueva",this.modoEdicion="nueva",this.routineForm.reset({nombrePrograma:"",diagnostico:"",semanas:2}),this.semanasRutina=[],this.selectedWeekIndex=0,this.actualizarSemanas()):(this.activeTab="editar",this.modoEdicion="editar",this.programaActivo&&this.cargarProgramaActivo()),this.formValueOrigin=JSON.stringify({form:this.routineForm.value,semanas:this.semanasRutina}))}seleccionarTipoDia(t,e){if(e==="rutina"){let a=(this.semanasRutina.length>0?this.semanasRutina[this.selectedWeekIndex].dias:this.diasSemana)[t],c=a.dia,b=a.ejercicios||[];this.dialog.open(Q,{width:"90%",maxWidth:"900px",data:{dayIndex:t,dayName:c,exercises:b},panelClass:"exercises-modal-panel",disableClose:!1}).afterClosed().subscribe(U=>{U&&(this.semanasRutina.length>0?(this.semanasRutina[this.selectedWeekIndex].dias[t].tipo="rutina",this.semanasRutina[this.selectedWeekIndex].dias[t].ejercicios=U.exercises):(this.diasSemana[t].tipo="rutina",this.diasSemana[t].ejercicios=U.exercises))})}else this.semanasRutina.length>0?this.semanasRutina[this.selectedWeekIndex].dias[t].tipo=e:this.diasSemana[t].tipo=e}abrirModalEjercicios(t){let o=(this.semanasRutina.length>0?this.semanasRutina[this.selectedWeekIndex].dias:this.diasSemana)[t],a=o.dia,c=o.ejercicios||[];this.dialog.open(Q,{width:"90%",maxWidth:"900px",data:{dayIndex:t,dayName:a,exercises:c},panelClass:"exercises-modal-panel",disableClose:!1}).afterClosed().subscribe(y=>{y&&(this.semanasRutina.length>0?this.semanasRutina[this.selectedWeekIndex].dias[t].ejercicios=y.exercises:this.diasSemana[t].ejercicios=y.exercises)})}cambiarDia(t){this.semanasRutina.length>0?this.semanasRutina[this.selectedWeekIndex].dias[t].tipo=null:this.diasSemana[t].tipo=null}iniciarCopia(t){this.copiedFromIndex=t}cancelarCopia(){this.copiedFromIndex=null}pegarRutina(t){if(this.copiedFromIndex!==null){let o=(this.semanasRutina.length>0?this.semanasRutina[this.selectedWeekIndex].dias:this.diasSemana)[this.copiedFromIndex];this.semanasRutina.length>0?(this.semanasRutina[this.selectedWeekIndex].dias[t].tipo=o.tipo,this.semanasRutina[this.selectedWeekIndex].dias[t].ejercicios=o.ejercicios?JSON.parse(JSON.stringify(o.ejercicios)):void 0):(this.diasSemana[t].tipo=o.tipo,this.diasSemana[t].ejercicios=o.ejercicios?JSON.parse(JSON.stringify(o.ejercicios)):void 0),this.copiedFromIndex=null}}eliminarRutinaDia(t){this.semanasRutina.length>0?this.semanasRutina[this.selectedWeekIndex].dias[t].tipo=null:this.diasSemana[t].tipo=null,this.copiedFromIndex===t&&(this.copiedFromIndex=null)}seleccionarSemana(t){this.selectedWeekIndex=t}getSelectedWeekDias(){return this.semanasRutina.length>0&&this.selectedWeekIndex<this.semanasRutina.length?this.semanasRutina[this.selectedWeekIndex].dias:this.diasSemana}iniciarCopiaSemana(t){this.copiedWeekIndex=t}cancelarCopiaSemana(){this.copiedWeekIndex=null}pegarSemana(t){this.copiedWeekIndex!==null&&this.copiedWeekIndex!==t&&(this.semanasRutina[t].dias=JSON.parse(JSON.stringify(this.semanasRutina[this.copiedWeekIndex].dias)),this.copiedWeekIndex=null)}resetearSemana(t){this.semanasRutina[t].dias=this.semanasRutina[t].dias.map(e=>Y(X({},e),{tipo:null}))}contarRutinas(t){return t.dias.filter(e=>e.tipo==="rutina").length}allDaysAssigned(){return this.semanasRutina.length>0?this.semanasRutina.every(t=>t.dias.every(e=>e.tipo!==null)):this.diasSemana.every(t=>t.tipo!==null)}isFieldInvalid(t){let e=this.routineForm.get(t);return!!(e&&e.invalid&&(e.dirty||e.touched))}hasChanges(){return JSON.stringify({form:this.routineForm.value,semanas:this.semanasRutina})!==this.formValueOrigin}onCancel(){return Z(this,null,function*(){this.hasChanges()?(yield this.dialog.open(q,{width:"90%",maxWidth:"500px",data:{title:"\xBFDescartar cambios?",message:"Tienes cambios sin guardar en la rutina. Si contin\xFAas, se perder\xE1n todos los datos ingresados."},disableClose:!1}).afterClosed().toPromise())&&this.dialogRef.close():this.dialogRef.close()})}onSubmit(){if(this.routineForm.valid&&this.allDaysAssigned()){this.isSubmitting=!0,this.dialogRef.disableClose=!0;let t=this.routineForm.value,e=this.semanasRutina[0],o=0;for(let h=0;h<e.dias.length;h++)if(e.dias[h].tipo!==null){o=h;break}let a=new Date,c=a.getDay(),b=c===0?-6:1-c,y=new Date(a);y.setDate(y.getDate()+b),y.setHours(0,0,0,0),y.setDate(y.getDate()+o);let U=y.toISOString(),_e={pacienteId:this.pacienteId,nombrePrograma:t.nombrePrograma,descripcion:"",diagnostico:t.diagnostico,semanas:t.semanas,fechaInicio:U,semanasRutina:this.semanasRutina.map(h=>({numeroSemana:h.semana,dias:h.dias.map((R,$e)=>({nombreDia:R.dia,ordenDia:$e+1,tipo:R.tipo==="rutina"?"rutina":"descanso",nombreRutina:R.tipo==="rutina"?R.dia:void 0,ejercicios:R.tipo==="rutina"&&R.ejercicios?R.ejercicios.map((H,Ge)=>({orden:Ge+1,nombre:H.nombre,descripcion:H.descripcion,repeticiones:H.repeticiones,tiempoDescanso:H.descanso,instrucciones:H.instrucciones})):void 0}))}))};this.modoEdicion==="editar"&&this.programaActivo?this.programaService.actualizarPrograma(this.programaActivo.id,_e).pipe(P(this.destroy$)).subscribe({next:h=>{this.dialogRef.close({success:!0,programa:h,mensaje:"Programa actualizado exitosamente"})},error:h=>{console.error("Error al actualizar programa:",h),this.toastService.error("Error al actualizar el programa"),this.isSubmitting=!1,this.dialogRef.disableClose=!1}}):this.programaService.crearPrograma(_e).pipe(P(this.destroy$)).subscribe({next:h=>{this.dialogRef.close({success:!0,programa:h,mensaje:"Programa de rehabilitaci\xF3n asignado exitosamente"})},error:h=>{console.error("Error al crear programa:",h),this.isSubmitting=!1,this.dialogRef.disableClose=!1,this.toastService.error("Error al crear el programa de rehabilitaci\xF3n. Por favor, intenta nuevamente.")}})}}ngOnDestroy(){this.destroy$.next(),this.destroy$.complete()}static \u0275fac=function(e){return new(e||s)(_(de),_(me),_(Pe),_(De),_(k),_(j))};static \u0275cmp=S({type:s,selectors:[["app-assign-routine-modal"]],decls:64,vars:18,consts:[[1,"w-full","max-w-5xl","flex","flex-col","max-h-[95vh]","overflow-hidden"],[1,"flex","items-center","justify-between","mb-6","pb-4","border-b","border-border","px-6","pt-6","flex-shrink-0"],[1,"flex-1"],[1,"text-3xl","font-bold","text-foreground"],[1,"text-sm","text-muted-foreground","mt-2"],["type","button","title","Cerrar",1,"ml-4","p-0","rounded-lg","hover:bg-muted","transition-colors","text-muted-foreground","hover:text-foreground","flex-shrink-0",3,"click"],["class","px-6 mb-4 flex-shrink-0",4,"ngIf"],[1,"overflow-y-auto","flex-1","px-6","pb-6"],[1,"space-y-6",3,"formGroup"],[1,"border","border-border","rounded-lg","p-6"],[1,"text-lg","font-semibold","text-foreground","mb-4","flex","items-center","gap-2"],[1,"text-primary"],[1,"space-y-4"],[1,"space-y-2"],[1,"text-sm","font-semibold","text-foreground","flex","items-center","gap-2"],["type","text","formControlName","nombrePrograma","placeholder","Ej: Rehabilitaci\xF3n de rodilla - Programa completo",1,"w-full","px-4","py-3","border","border-input","rounded-lg","bg-background","text-foreground","placeholder:text-muted-foreground","focus:outline-none","focus:ring-2","focus:ring-primary","focus:border-transparent","transition-all"],["class","text-sm text-destructive flex items-center gap-1 mt-1",4,"ngIf"],["formControlName","diagnostico","placeholder","Describe el diagn\xF3stico","rows","1",1,"w-full","px-4","py-3","border","border-input","rounded-lg","bg-background","text-foreground","placeholder:text-muted-foreground","focus:outline-none","focus:ring-2","focus:ring-primary","focus:border-transparent","transition-all","resize-none"],[1,"flex","items-center","gap-2"],["type","button",1,"px-4","py-3","rounded-lg","border","border-input","bg-background","hover:bg-muted","disabled:opacity-50","disabled:cursor-not-allowed","transition-colors","font-semibold","text-lg","flex","items-center","justify-center","w-12","h-12","flex-shrink-0",3,"click","disabled"],["type","number","formControlName","semanas","readonly","",1,"flex-1","px-4","py-3","border","border-input","rounded-lg","bg-background","text-foreground","placeholder:text-muted-foreground","focus:outline-none","focus:ring-2","focus:ring-primary","focus:border-transparent","transition-all","text-center","font-semibold"],["type","button",1,"px-4","py-3","rounded-lg","border","border-input","bg-background","hover:bg-muted","transition-colors","font-semibold","text-lg","flex","items-center","justify-center","w-12","h-12","flex-shrink-0",3,"click"],[1,"text-sm","text-muted-foreground"],["class","border border-border rounded-lg p-6",4,"ngIf"],["class","ml-2 px-3 py-1 rounded-full bg-primary/20 text-primary text-sm font-medium",4,"ngIf"],[1,"space-y-3"],["class","p-4 rounded-lg border border-border bg-muted/30 hover:bg-muted/50 transition-colors",4,"ngFor","ngForOf"],[1,"flex","gap-3","px-6","pb-6","border-t","border-border","flex-shrink-0","pt-6"],["type","button",1,"flex-1","px-4","py-3","rounded-lg","border","border-border","text-foreground","bg-background","hover:bg-muted","transition-colors","font-medium",3,"click"],["type","submit",1,"flex-1","px-4","py-3","rounded-lg","bg-primary","text-primary-foreground","hover:bg-primary/90","transition-colors","disabled:opacity-50","disabled:cursor-not-allowed","font-medium","flex","items-center","justify-center","gap-2",3,"click","disabled"],[4,"ngIf"],[1,"px-6","mb-4","flex-shrink-0"],[1,"flex","gap-2","border-b","border-border"],["type","button",3,"click"],[1,"text-sm","text-destructive","flex","items-center","gap-1","mt-1"],[1,"grid","grid-cols-2","gap-3"],[3,"class","click",4,"ngFor","ngForOf"],[3,"click"],[1,"flex","items-center","justify-between","gap-3","mb-3"],[1,"font-semibold","text-foreground"],["type","button",1,"flex-1","px-2","py-2","rounded-lg","border","border-blue-300/50","text-blue-600","bg-blue-50","hover:bg-blue-100","transition-colors","text-xs","font-medium","flex","items-center","justify-center","gap-1",3,"click"],["type","button",1,"flex-1","px-2","py-2","rounded-lg","border","border-destructive/30","text-destructive","bg-destructive/5","hover:bg-destructive/10","transition-colors","text-xs","font-medium","flex","items-center","justify-center","gap-1",3,"click"],["type","button",1,"flex-1","px-2","py-2","rounded-lg","bg-blue-500","text-white","hover:bg-blue-600","disabled:opacity-50","disabled:cursor-not-allowed","transition-colors","text-xs","font-medium","flex","items-center","justify-center","gap-1",3,"click","disabled"],["type","button",1,"flex-1","px-2","py-2","rounded-lg","border","border-border","text-foreground","bg-background","hover:bg-muted","transition-colors","text-xs","font-medium",3,"click"],[1,"ml-2","px-3","py-1","rounded-full","bg-primary/20","text-primary","text-sm","font-medium"],[1,"p-4","rounded-lg","border","border-border","bg-muted/30","hover:bg-muted/50","transition-colors"],[1,"flex","items-center","justify-between","gap-4"],[1,"flex","items-center","gap-3"],[1,"text-muted-foreground"],["class","mt-1",4,"ngIf"],[1,"mt-1"],[1,"inline-block","px-3","py-1","rounded-full","bg-blue-500/20","text-blue-600","text-xs","font-medium"],[1,"inline-block","px-3","py-1","rounded-full","bg-green-500/20","text-green-600","text-xs","font-medium"],["type","button",1,"px-3","py-2","rounded-lg","border","border-border","text-foreground","bg-background","hover:bg-muted","transition-colors","text-sm","font-medium",3,"click"],["type","button",1,"px-3","py-2","rounded-lg","bg-primary","text-primary-foreground","hover:bg-primary/90","transition-colors","text-sm","font-medium",3,"click"],["type","button",1,"px-3","py-2","rounded-lg","bg-blue-500","text-white","hover:bg-blue-600","transition-colors","text-sm","font-medium","flex","items-center","gap-1",3,"click"],["type","button",1,"px-3","py-2","rounded-lg","bg-primary","text-primary-foreground","hover:bg-primary/90","transition-colors","text-sm","font-medium","flex","items-center","gap-1",3,"click"],["type","button",1,"px-3","py-2","rounded-lg","border","border-blue-300/50","text-blue-600","bg-blue-50","hover:bg-blue-100","transition-colors","text-sm","font-medium","flex","items-center","gap-1",3,"click"],["type","button",1,"px-3","py-2","rounded-lg","border","border-destructive/30","text-destructive","bg-destructive/5","hover:bg-destructive/10","transition-colors","text-sm","font-medium",3,"click"]],template:function(e,o){if(e&1&&(n(0,"div",0)(1,"div",1)(2,"div",2)(3,"h2",3),r(4),i(),n(5,"p",4),r(6),i()(),n(7,"button",5),u("click",function(){return o.onCancel()}),n(8,"mat-icon"),r(9,"close"),i()()(),f(10,rt,6,4,"div",6),n(11,"div",7)(12,"form",8)(13,"div",9)(14,"h3",10)(15,"mat-icon",11),r(16,"info"),i(),r(17," Informaci\xF3n del Programa "),i(),n(18,"div",12)(19,"div",13)(20,"label",14)(21,"mat-icon",11),r(22,"fitness_center"),i(),r(23," Nombre del Programa * "),i(),O(24,"input",15),f(25,at,4,0,"div",16),i(),n(26,"div",13)(27,"label",14)(28,"mat-icon",11),r(29,"description"),i(),r(30," Diagn\xF3stico * "),i(),O(31,"textarea",17),f(32,st,4,0,"div",16),i(),n(33,"div",13)(34,"label",14)(35,"mat-icon",11),r(36,"calendar_today"),i(),r(37," Duraci\xF3n del Programa (semanas) * "),i(),n(38,"div",18)(39,"button",19),u("click",function(){return o.decrementarSemanas()}),r(40," \u2212 "),i(),O(41,"input",20),n(42,"button",21),u("click",function(){return o.incrementarSemanas()}),r(43," + "),i()(),n(44,"p",22),r(45),i(),f(46,lt,4,0,"div",16),i()()(),f(47,ut,7,1,"div",23),n(48,"div",9)(49,"h3",10)(50,"mat-icon",11),r(51,"event"),i(),r(52," Planificaci\xF3n Semanal "),f(53,pt,2,1,"span",24),i(),n(54,"div",25),f(55,yt,16,8,"div",26),i()()()(),n(56,"div",27)(57,"button",28),u("click",function(){return o.onCancel()}),r(58," Cancelar "),i(),n(59,"button",29),u("click",function(){return o.onSubmit()}),f(60,Ct,2,0,"mat-icon",30)(61,St,2,0,"span",30)(62,Et,2,1,"span",30)(63,Mt,2,0,"span",30),i()()()),e&2){let a,c,b,y;l(4),x(o.programaActivo?"Gesti\xF3n de Rutina":"Asignar Rutina"),l(2),C("Paciente: ",o.pacienteName,""),l(4),m("ngIf",o.programaActivo),l(2),m("formGroup",o.routineForm),l(13),m("ngIf",o.isFieldInvalid("nombrePrograma")),l(7),m("ngIf",o.isFieldInvalid("diagnostico")),l(7),m("disabled",(((a=o.routineForm.get("semanas"))==null?null:a.value)||1)<=1),l(6),Se(" Este patr\xF3n semanal se repetir\xE1 durante ",(c=o.routineForm.get("semanas"))==null?null:c.value," ",((c=o.routineForm.get("semanas"))==null?null:c.value)===1?"semana":"semanas"," "),l(),m("ngIf",o.isFieldInvalid("semanas")),l(),m("ngIf",(((b=o.routineForm.get("semanas"))==null?null:b.value)||0)>1),l(6),m("ngIf",(((y=o.routineForm.get("semanas"))==null?null:y.value)||0)>1),l(2),m("ngForOf",o.getSelectedWeekDias()),l(4),m("disabled",!o.routineForm.valid||o.isSubmitting||!o.allDaysAssigned()),l(),m("ngIf",o.isSubmitting),l(),m("ngIf",!o.isSubmitting&&o.modoEdicion==="editar"),l(),m("ngIf",!o.isSubmitting&&o.modoEdicion==="nueva"),l(),m("ngIf",o.isSubmitting)}},dependencies:[E,G,D,B,ae,J,se,L,re,le,ce,w,I,M],styles:[":is()   .mat-mdc-dialog-container[_ngcontent-%COMP%]{padding:0!important}:is()   .exercises-modal-panel[_ngcontent-%COMP%]{z-index:1200!important}:is()   .cdk-overlay-pane[_ngcontent-%COMP%]:has(.exercises-modal-panel){z-index:1200!important}"]})};var It=(s,t)=>({"flex items-center justify-center w-12 h-12 rounded-full bg-destructive/10":s,"flex items-center justify-center w-12 h-12 rounded-full bg-warning/10":t}),kt=(s,t)=>({"text-destructive":s,"text-warning":t}),wt=(s,t)=>({"flex-1 px-4 py-2 rounded-lg text-white transition-colors font-medium bg-destructive hover:bg-destructive/90":s,"flex-1 px-4 py-2 rounded-lg text-white transition-colors font-medium bg-warning hover:bg-warning/90":t});function Dt(s,t){if(s&1&&(n(0,"div",22)(1,"mat-icon",23),r(2,"person"),i(),n(3,"div",4)(4,"p",24),r(5,"Paciente"),i(),n(6,"p",25),r(7),i()()()),s&2){let e=d(2);l(7),x(e.data.paciente)}}function jt(s,t){if(s&1&&(n(0,"div",26)(1,"mat-icon",23),r(2,"calendar_today"),i(),n(3,"div",4)(4,"p",24),r(5,"Fecha"),i(),n(6,"p",25),r(7),ne(8,"date"),i()()()),s&2){let e=d(2);l(7),x(Me(8,1,e.data.fecha,"dd/MM/yyyy"))}}function Rt(s,t){if(s&1&&(n(0,"div",26)(1,"mat-icon",23),r(2,"access_time"),i(),n(3,"div",4)(4,"p",24),r(5,"Hora"),i(),n(6,"p",25),r(7),i()()()),s&2){let e=d(2);l(7),x(e.data.hora)}}function Tt(s,t){if(s&1&&(n(0,"div",22)(1,"mat-icon",23),r(2,"person"),i(),n(3,"div",4)(4,"p",24),r(5,"Paciente"),i(),n(6,"p",25),r(7),i()()()),s&2){let e=d(2);l(7),x(e.data.pacienteNombre)}}function At(s,t){if(s&1&&(n(0,"div",26)(1,"mat-icon",23),r(2,"email"),i(),n(3,"div",4)(4,"p",24),r(5,"Email"),i(),n(6,"p",27),r(7),i()()()),s&2){let e=d(2);l(7),x(e.data.pacienteEmail)}}function Ft(s,t){if(s&1&&(n(0,"div",26)(1,"mat-icon",23),r(2,"phone"),i(),n(3,"div",4)(4,"p",24),r(5,"Tel\xE9fono"),i(),n(6,"p",25),r(7),i()()()),s&2){let e=d(2);l(7),x(e.data.pacienteTelefono)}}function Vt(s,t){if(s&1&&(n(0,"div",26)(1,"mat-icon",23),r(2,"description"),i(),n(3,"div",4)(4,"p",24),r(5,"Diagn\xF3stico"),i(),n(6,"p",28),r(7),i()()()),s&2){let e=d(2);l(7),x(e.data.diagnostico)}}function Pt(s,t){if(s&1){let e=v();n(0,"div",2)(1,"div",3)(2,"div",4)(3,"h2",5),r(4),i(),n(5,"p",6),r(6,"Esta acci\xF3n no se puede deshacer"),i()(),n(7,"button",7),u("click",function(){p(e);let a=d();return g(a.onCancel())}),n(8,"mat-icon"),r(9,"close"),i()()(),n(10,"div",8)(11,"div",9)(12,"div",10)(13,"mat-icon",11),r(14,"warning"),i()()(),n(15,"div",12)(16,"p",13),r(17),i(),n(18,"p",14),r(19," Una vez realizada, no podr\xE1s recuperar esta informaci\xF3n. "),i()(),n(20,"div",15),f(21,Dt,8,1,"div",16)(22,jt,9,4,"div",17)(23,Rt,8,1,"div",17)(24,Tt,8,1,"div",16)(25,At,8,1,"div",17)(26,Ft,8,1,"div",17)(27,Vt,8,1,"div",17),i()(),n(28,"div",18)(29,"button",19),u("click",function(){p(e);let a=d();return g(a.onCancel())}),r(30," Cancelar "),i(),n(31,"button",20),u("click",function(){p(e);let a=d();return g(a.onConfirm())}),n(32,"mat-icon",21),r(33),i(),n(34,"span"),r(35),i()()()()}if(s&2){let e=d();l(4),x(e.data.paciente?"Eliminar Cita":"Desvincular Paciente"),l(13),C(" ",e.data.message||(e.data.paciente?"\xBFEst\xE1s seguro de que deseas eliminar esta cita?":"\xBFEst\xE1s seguro de que deseas desvincular este paciente?")," "),l(4),m("ngIf",e.data.paciente&&e.data.fecha),l(),m("ngIf",e.data.paciente&&e.data.fecha),l(),m("ngIf",e.data.paciente&&e.data.hora),l(),m("ngIf",e.data.pacienteNombre&&!e.data.paciente),l(),m("ngIf",e.data.pacienteEmail&&!e.data.paciente),l(),m("ngIf",e.data.pacienteTelefono&&!e.data.paciente),l(),m("ngIf",e.data.diagnostico&&!e.data.paciente),l(6),x(e.data.paciente?"delete":"link_off"),l(2),x(e.data.paciente?"Eliminar Cita":"Desvincular")}}function Ot(s,t){if(s&1){let e=v();n(0,"div",29)(1,"div",30)(2,"div",31)(3,"mat-icon",31),r(4),i()(),n(5,"h2",32),r(6),i()(),n(7,"p",33),r(8),i(),n(9,"div",34)(10,"button",35),u("click",function(){p(e);let a=d();return g(a.onCancel())}),r(11),i(),n(12,"button",36),u("click",function(){p(e);let a=d();return g(a.onConfirm())}),r(13),i()()()}if(s&2){let e=d();l(2),m("ngClass",ie(8,It,e.isDangerous,!e.isDangerous)),l(),m("ngClass",ie(11,kt,e.isDangerous,!e.isDangerous)),l(),C(" ",e.isDangerous?"delete_outline":"warning"," "),l(2),x(e.title),l(2),x(e.message),l(3),C(" ",e.cancelText," "),l(),m("ngClass",ie(14,wt,e.isDangerous,!e.isDangerous)),l(),C(" ",e.confirmText," ")}}var ze=class s{constructor(t,e){this.dialogRef=t;this.data=e;this.title=e.title||"Confirmar acci\xF3n",this.message=e.message||"\xBFEst\xE1s seguro de que deseas continuar?",this.confirmText=e.confirmText||"Confirmar",this.cancelText=e.cancelText||"Cancelar",this.isDangerous=e.isDangerous!==!1}title;message;confirmText;cancelText;isDangerous;onCancel(){this.dialogRef.close(!1)}onConfirm(){this.dialogRef.close(!0)}static \u0275fac=function(e){return new(e||s)(_(k),_(j))};static \u0275cmp=S({type:s,selectors:[["app-confirm-delete-modal"]],decls:3,vars:2,consts:[["genericDelete",""],["class","w-full max-w-2xl flex flex-col max-h-[90vh]",4,"ngIf","ngIfElse"],[1,"w-full","max-w-2xl","flex","flex-col","max-h-[90vh]"],[1,"flex","items-center","justify-between","mb-8","pb-6","border-b","border-border","px-6","pt-6","flex-shrink-0"],[1,"flex-1"],[1,"text-2xl","font-bold","text-foreground"],[1,"text-sm","text-muted-foreground","mt-2"],["type","button","title","Cerrar",1,"ml-4","p-2","rounded-lg","hover:bg-muted","transition-colors","text-muted-foreground","hover:text-foreground","flex-shrink-0",3,"click"],[1,"overflow-y-auto","flex-1","px-6"],[1,"flex","justify-center","mb-8"],[1,"w-16","h-16","bg-red-100","rounded-full","flex","items-center","justify-center"],[1,"text-red-600","!size-8"],[1,"text-center","mb-8"],[1,"text-foreground","mb-4"],[1,"text-sm","text-muted-foreground"],[1,"bg-muted/30","border","border-border","rounded-lg","p-6","space-y-4","mb-8"],["class","flex items-start gap-3",4,"ngIf"],["class","border-t border-border pt-4 flex items-start gap-3",4,"ngIf"],[1,"flex","gap-3","px-6","pb-6","border-t","border-border","flex-shrink-0","pt-6"],["type","button",1,"flex-1","px-4","py-3","rounded-lg","border","border-border","text-foreground","bg-background","hover:bg-muted","transition-colors","disabled:opacity-50","disabled:cursor-not-allowed","font-medium",3,"click"],["type","button",1,"flex-1","px-4","py-3","rounded-lg","bg-red-600","text-white","hover:bg-red-700","transition-colors","disabled:opacity-50","disabled:cursor-not-allowed","font-medium","flex","items-center","justify-center","gap-2",3,"click"],[1,"!size-4"],[1,"flex","items-start","gap-3"],[1,"text-muted-foreground","!size-5","mt-0.5","flex-shrink-0"],[1,"text-xs","font-semibold","text-muted-foreground"],[1,"text-foreground","font-medium"],[1,"border-t","border-border","pt-4","flex","items-start","gap-3"],[1,"text-foreground","font-medium","text-sm","truncate"],[1,"text-foreground","font-medium","text-sm"],[1,"p-6","max-w-md"],[1,"flex","items-center","gap-3","mb-4"],[3,"ngClass"],[1,"text-xl","font-bold","text-foreground"],[1,"text-muted-foreground","mb-6","text-sm"],[1,"flex","gap-3"],[1,"flex-1","px-4","py-2","rounded-lg","border","border-input","text-foreground","bg-background","hover:bg-muted","transition-colors","font-medium",3,"click"],[3,"click","ngClass"]],template:function(e,o){if(e&1&&f(0,Pt,36,11,"div",1)(1,Ot,14,17,"ng-template",null,0,oe),e&2){let a=te(2);m("ngIf",o.data.paciente&&o.data.fecha||o.data.pacienteNombre&&(o.data.pacienteEmail||o.data.pacienteTelefono))("ngIfElse",a)}},dependencies:[E,Ie,D,we,w,I,M],styles:["[_nghost-%COMP%]     .mat-mdc-dialog-container{padding:0!important}"]})};export{Oe as a,We as b,ze as c};
